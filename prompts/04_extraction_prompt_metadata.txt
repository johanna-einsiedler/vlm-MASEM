Goal

Extract study- and sample-level metadata from a parsed paper, using:
(1) the full parsed paper text, and
(2) previously extracted factor-analytic results (factor loadings + factor correlations) provided as JSON input.

Your task is to output one clean metadata record per sample/group reported in the paper.


Inputs

You will be given two inputs:

A) EXTRACTED_RESULTS_JSON
- This is a JSON object containing extracted factor loadings and/or factor correlations.
- It includes one ample with a sample_id field.

B) PAPER_TEXT
- The full parsed paper as plain text/markdown.


What to output

Return exactly one valid JSON object (parsable by json.loads). No extra text.

JSON schema
{
  "records": [
    {
      "pubyear": number,
      "country": "string|null",
      "continent": "string|null",
      "lang": "string|null",
      "pubtype": number|null,
      "n": number|null,
      "sex": number|null,
      "age": number|null,
      "clinical": number|null,
      "res": number|null,
      "nfac": number|null,
      "cfa": number|null,
      "met": number|null,
      "rot": number|null,
    }
  ]
}


Variables (must follow exactly)

pubyear:
- Publication year (<= 2020 per spec).
- Extract from the paper (preferred) or from citation header. If not visible, null.

country:
- Country of origin of participants (open text).
- Only fill if explicitly stated or clearly inferable from recruitment location (e.g., “German university students in Berlin” -> Germany).
- If origin is unclear, but the affiliation of the authors is mainly from United States, USA
- If United States, USA
- If unclear, null.

continent:
- Continent of origin of participants (open text).
- If country is available, map the country to the continent.
- If country is null and continent is explicitly stated, fill continent; otherwise null.

lang:
- Language of questionnaire (open text), e.g., "German", "English", "French".
- Use explicit statements like “German version”, “translated into …”, etc. If not stated, null.
- If multiple versions are used („German“, „English“), then take into account the variable source_sample_id provided with the extracted factor loadings and correlations
- If no language is explicitly mentioned, but the sample originates from an English-speaking country, English

pubtype:
- Publication type:
  1 = article in journal
  2 = book
  3 = thesis (master/phd)
  4 = presentation/proceedings
  5 = other
- Determine from the paper context; if uncertain, null and explain in notes.

n:
- Sample size (integer).
- Usually this information is given in the abstract or in the sample description (method) following statement like „sample is comprised …“, „sample consists of…“, „adminstered to…“
- If multiple groups, use the n corresponding to the record’s sample_id.
- If not clearly matched, set null and describe ambiguity in notes.

sex:
- Percentage of women in sample (%) in [0, 100].
- Extract if reported. If only counts are reported, compute percentage if n is known. Sometimes not all participants of the study report their gender, so compute and report percentage as ratio women/(women + men); mention computation in notes.
- If not reported, null.

age:
- Mean age (years).
- Usually this information is given in the abstract or in the sample description (method).
- If mean age is reported separately for gender groups, compute subsample-size weighted mean.
- Prefer mean; if only a range/median is given, set null and note.

clinical:
- 0 = no (non-clinical)
- 1 = yes (clinical patients)
- 2 = mixed
- Determine from sample description; if unclear, null.

res:
- Number of response options (Likert points), integer >= 5.
- Extract from TAS-20 response format description (e.g., “5-point Likert scale” -> 5).
- If there is no mentioning of adaption or translation, 5 
- Otherwise, null.

nfac:
- Number of extracted factors (1–10).
- Determine from the factor-analytic model described in the paper AND/OR from EXTRACTED_RESULTS_JSON (e.g., if loadings include F1..F3 -> 3).
- If inconsistent across models, prefer the main/final/preferred solution used for the extracted results; explain in notes.

cfa:
- Factoranalytic type:
  0 = EFA
  1 = CFA
- Usually this information is given in the section „Analytical Procedure“ or „Statistical Analysis“ or in the title or notes of the results
- Search for expressions like exploratory factor analysis (EFA) or confirmatory factor analysis (CFA)
- Determine based on the method corresponding to the extracted results.
- If both EFA and CFA exist but extracted results correspond to one, code that one and note both in notes.


met:
- Extraction/estimation method:
  1 = principal component
  2 = principal axis
  3 = maximum likelihood
  4 = other
- Usually this information is given in the section „Analytical Procedure“ or „Statistical Analysis“ or in the title or notes of the results
- Search for expressions like „principal component“ (PCA), „principal axis“ (PAF) or „maximum likelihood“ (ML) 
- Use the method used for the extracted solution. If not stated, null.
- If “other”, briefly name it in notes (e.g., “ULS”, “WLSMV”, “GLS”, “Bayesian”, etc.).

rot:
- Rotation method:
  1 = orthogonal (e.g., varimax)
  2 = oblique (e.g., oblimin, promax)
- Search for terms such as “varimax,” “quartimax,” “equamax,” “orthomax,” and “parsimax” and classify the method as an orthogonal rotation.
- Search for terms such as “promax,” “oblimin,” “quartimin,” “biquartimin,” and “geomin” and classify the method as an oblique rotation.
- If all factor correlations are all zero, 1


Matching rules: linking metadata to extracted samples
- Use sample_id labels inside EXTRACTED_RESULTS_JSON (e.g., "sample1", "clinical", "english", "french") to find the corresponding group in PAPER_TEXT.
- Match by explicit headings, group descriptors, or n values if uniquely identifiable.


Strict rules

- Do not invent values.
- If a value is not explicitly stated, cannot be reasonably inferred from the paper text, and no default is specified in the description above, use null.
- The output must be JSON only, no markdown, no commentary.


Now perform the task:
